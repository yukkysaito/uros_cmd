#define _GNU_SOURCE         /* See feature_test_macros(7) */
#include "ros/ros.h"
#include "turtlesim/Velocity.h"
#include <conio.h>

int main(int argc, char **argv)
{

    ros::init(argc, argv, "turtle_cmd");
    ros::NodeHandle n;

    ros::Publisher cmd_pub = n.advertise<turtlesim::Velocity>("/turtle1/command_velocity", 1);
    ros::Rate loop_rate(10); //10Hz

    while (ros::ok())
    {
        int c;
        printf("input key(up,down,left,right): ");
        c = getch();
        switch((c == 0x00 || c == 0xe0) ? getch(): c) {
        case 0x48: // Up
            printf("Up");
            break;
        case 0x4b: // Left
            printf("Left");
            break;
        case 0x4d: // Right
            printf("Right");
            break;
        case 0x50: //Down
            printf("Down");
        }

        turtlesim::Velocity msg;
        msg.angular = 15;
        cmd_pub.publish(msg);

        ros::spinOnce();
        loop_rate.sleep();
    }
    return 0;
}
